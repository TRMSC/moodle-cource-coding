<!-- Moodle Scroll Trigger v.0.5 - Copyright (C) 2022, TRMSC - https://trmsc1.wordpress.com/ -->
<!-- GNU General Public Licence 3.0 - http://www.gnu.de/documents/gpl-3.0.en.html -->

<!-- TESTED ONLY IN MOODLE 3.9.11 CLASSIC THEME -->
<!-- PUT THE CODE INTO A TEXTBLOCK OR TEXTFIELD (HTML-MODE) ON COURSE-SITE AND OBSERVE THE NOTES BELOW -->

<script>
    window.addEventListener('load', function(event) {
        let jquery_load_check_interval = setInterval(function() {
            if (window.jQuery) {
                console.log('jQuery in Moodle: jQuery v.' + $.fn.jquery + ' loaded');
                console.log('Moodle Scroll Trigger v.0.5');
                triggerIdCount = 0;

                /* REMOVE THE TWO SLASHS AT THE BEGINNING OF THE LINE BELOW. */
		/* ADD A SELECTOR AND DIRECTION TO ACTIVATE ELEMENT FOR SCROLL TRIGGERING */
		/* COPY THE LINE FOR TRIGGERING MORE ELEMENTS */
		    
                // scrollTrigger("#id .class or element", "left or right"); 


                clearInterval(jquery_load_check_interval);
            } else {
                console.log('jQuery in Moodle: new try to load jquery...');
            }
        }, 150);

        function scrollTrigger(trg, trgDir) {
            if (trg.includes("#")) {
                console.log("Scroll Trigger found: " + trg);
                startTrigger(trg, trgDir);
            } else {
                jQuery(trg).each(function() {
                    if (this.id == 0) {
                        jQuery(this).attr("id", "triggerID" + triggerIdCount);
                        trg = "#" + this.id;
                        console.log("Scroll Trigger added: " + trg);
                        triggerIdCount++;
                        startTrigger(trg, trgDir);
                    } else {
                        trg = "#" + this.id;
                        console.log("Scroll Trigger found: " + trg);
                        startTrigger(trg, trgDir);
                    }
                });
            }
        }

        function startTrigger(trg, trgDir) {
            console.log("Start scroll-trigger from " + trgDir + " for " + trg);
            jQuery(trg).css("transition", "all 0.7s ease-in 0s");
            jQuery(window).scroll(function() {
                var hT = jQuery(trg).offset().top,
                    hH = jQuery(trg).outerHeight(),
                    wH = jQuery(window).height(),
                    wS = jQuery(this).scrollTop();
                if ((wS > (hT - 600)) && (wS < (hT + hH - 180))) {
                    jQuery(trg).css("opacity", "1");
                    jQuery(trg).css("transform", "translate(0px, 0px)");
                } else {
                    jQuery(trg).css("opacity", "0");
                    if (trgDir == "right") {
                        jQuery(trg).css("transform", "translate(50px, 0px)");
                    } else {
                        jQuery(trg).css("transform", "translate(-50px, 0px)");
                    }
                }
            });
            return;
        }

    }, false);
</script>
