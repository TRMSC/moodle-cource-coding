<script>
/**
 * @name Moodle Backbutton v.0.2
 * @description Add a back button instead of the breadcrumb within activities
 * @license GNU General Public Licence 3.0 - http://www.gnu.de/documents/gpl-3.0.en.html
 * @copyright (C) 2022, TRMSC - https://trmsc1.wordpress.com/
 *
 * PLEASE TRY THIS CODE CAREFULLY WITHIN YOUR INDIVIDUAL MOODLE INSTANCE
 * TESTED WITH MOODLE 4.0.4 BOOST
 *
 */
(function() {
    let withinActivity = document.getElementsByClassName('path-mod');
    let withinCourse = document.getElementsByClassName('path-course-view');
    if ( (withinActivity.length > 0) || (withinCourse.length > 0) ) {  
        console.log ('Check');
        let check = document.getElementsByTagName("body")[0].classList;
        for (let i = 0; i < check.length; i++) {
            if (withinActivity.length > 0 && check[i].includes('course-')) {
                let coursenumber = check[i].replace(/c.+-/g, "");
                const backbutton = 
                    '<a href="/moodle/course/view.php?id=' + coursenumber + '">zurück zum Kurs</a>';
                createBackbutton(backbutton);
                break;
            }
            if (withinCourse.length > 0 && check[i].includes('category-')) {
                let coursenumber = check[i].replace(/c.+-/g, "");
                const backbutton = 
                    '<a href="/moodle/course/index.php?categoryid=' + coursenumber + '">zurück zum Kursbereich</a>';
                createBackbutton(backbutton);
                break;
            }
        }
    }
})();

function createBackbutton(backbutton) {
    let buttoncontainer = document.createElement('div');
    buttoncontainer.classList.add('breadcrumb-item');
    buttoncontainer.style.margin = "8px 0px";
    buttoncontainer.innerHTML = backbutton;
    document.getElementById('page-header').prepend(buttoncontainer);
    document.getElementById("page-navbar").style.display = "none";
}
</script>
